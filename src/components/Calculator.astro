---
// Professional calculator component
---

<section id="calculator" class="relative py-24 bg-gradient-to-b from-white to-fog/30">
  <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
    <!-- Header -->
    <div class="text-center mb-16">
      <h2 class="font-display heading-lg text-midnight mb-4">
        Discover Your
        <span class="text-gradient"> Hidden Deductions</span>
      </h2>
      <p class="text-xl text-slate max-w-3xl mx-auto">
        Most artists miss 30-40% of their eligible tax deductions. Let's uncover yours with a CPA's expertise.
      </p>
    </div>
    
    <!-- Calculator card -->
    <div class="card-bold shadow-modern-lg">
      <form id="deduction-calculator" class="space-y-8">
        <!-- Annual income -->
        <div>
          <label class="block text-sm font-medium text-midnight mb-2">
            Annual Creative Income
          </label>
          <div class="relative">
            <span class="absolute left-4 top-1/2 -translate-y-1/2 text-xl text-slate">$</span>
            <input 
              type="number" 
              id="income" 
              class="w-full pl-12 pr-4 py-4 bg-white border-2 border-fog rounded-lg text-xl font-medium focus:border-teal focus:outline-none transition-colors"
              placeholder="30,000"
              min="0"
              step="1000"
            />
          </div>
          <p class="mt-2 text-sm text-slate">Include all income: sales, commissions, teaching, grants</p>
        </div>
        
        <!-- Income sources -->
        <div>
          <label class="block text-sm font-medium text-midnight mb-4">
            Income Sources (Check all that apply)
          </label>
          <div class="grid sm:grid-cols-2 gap-3">
            <label class="flex items-center gap-3 p-4 bg-white border-2 border-fog rounded-lg cursor-pointer hover:border-teal transition-colors">
              <input type="checkbox" class="w-5 h-5 text-teal rounded focus:ring-teal" value="gallery" />
              <span class="text-slate">Gallery Sales</span>
            </label>
            <label class="flex items-center gap-3 p-4 bg-white border-2 border-fog rounded-lg cursor-pointer hover:border-teal transition-colors">
              <input type="checkbox" class="w-5 h-5 text-teal rounded focus:ring-teal" value="online" />
              <span class="text-slate">Online Sales</span>
            </label>
            <label class="flex items-center gap-3 p-4 bg-white border-2 border-fog rounded-lg cursor-pointer hover:border-teal transition-colors">
              <input type="checkbox" class="w-5 h-5 text-teal rounded focus:ring-teal" value="commissions" />
              <span class="text-slate">Commissions</span>
            </label>
            <label class="flex items-center gap-3 p-4 bg-white border-2 border-fog rounded-lg cursor-pointer hover:border-teal transition-colors">
              <input type="checkbox" class="w-5 h-5 text-teal rounded focus:ring-teal" value="teaching" />
              <span class="text-slate">Teaching/Workshops</span>
            </label>
            <label class="flex items-center gap-3 p-4 bg-white border-2 border-fog rounded-lg cursor-pointer hover:border-teal transition-colors">
              <input type="checkbox" class="w-5 h-5 text-teal rounded focus:ring-teal" value="grants" />
              <span class="text-slate">Grants/Residencies</span>
            </label>
            <label class="flex items-center gap-3 p-4 bg-white border-2 border-fog rounded-lg cursor-pointer hover:border-teal transition-colors">
              <input type="checkbox" class="w-5 h-5 text-teal rounded focus:ring-teal" value="licensing" />
              <span class="text-slate">Licensing/Royalties</span>
            </label>
          </div>
        </div>
        
        <!-- Current deduction tracking -->
        <div>
          <label class="block text-sm font-medium text-midnight mb-4">
            What expenses do you currently track?
          </label>
          <div class="space-y-3">
            <label class="flex items-center gap-3">
              <input type="checkbox" class="w-5 h-5 text-teal rounded focus:ring-teal" value="supplies" checked />
              <span class="text-slate">Art supplies & materials</span>
            </label>
            <label class="flex items-center gap-3">
              <input type="checkbox" class="w-5 h-5 text-teal rounded focus:ring-teal" value="studio" />
              <span class="text-slate">Studio rent/home studio</span>
            </label>
            <label class="flex items-center gap-3">
              <input type="checkbox" class="w-5 h-5 text-teal rounded focus:ring-teal" value="travel" />
              <span class="text-slate">Travel for shows/research</span>
            </label>
            <label class="flex items-center gap-3">
              <input type="checkbox" class="w-5 h-5 text-teal rounded focus:ring-teal" value="marketing" />
              <span class="text-slate">Website/marketing costs</span>
            </label>
            <label class="flex items-center gap-3">
              <input type="checkbox" class="w-5 h-5 text-teal rounded focus:ring-teal" value="education" />
              <span class="text-slate">Classes/professional development</span>
            </label>
          </div>
        </div>
        
        <!-- Calculate button -->
        <button type="submit" class="w-full btn-primary">
          Calculate My Potential Savings
        </button>
      </form>
      
      <!-- Results (hidden initially) -->
      <div id="results" class="hidden mt-12 pt-8 border-t-2 border-fog">
        <div class="text-center space-y-6">
          <div class="inline-flex items-center gap-2 text-teal font-medium">
            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
            </svg>
            <span>Analysis Complete</span>
          </div>
          
          <div>
            <p class="text-lg text-slate mb-2">You're likely missing approximately:</p>
            <p class="font-serif text-5xl md:text-6xl text-coral">
              $<span id="missed-amount">0</span>
            </p>
            <p class="text-xl text-slate mt-2">in annual tax deductions</p>
          </div>
          
          <div class="bg-gradient-to-br from-teal/5 to-coral/5 rounded-xl p-6 text-left">
            <p class="font-semibold text-midnight mb-3">Common missed deductions for artists include:</p>
            <ul class="space-y-2 text-slate" id="missed-list">
              <!-- Populated by JavaScript -->
            </ul>
          </div>
          
          <div class="space-y-4">
            <p class="text-lg text-slate">
              That's <span id="monthly-savings" class="font-semibold text-teal">$0</span> 
              per month you could be saving
            </p>
            <button class="btn-coral">
              Let's Capture These Savings →
            </button>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Trust message -->
    <div class="text-center mt-12">
      <p class="text-sm text-slate">
        <svg class="w-4 h-4 inline mr-1 text-teal" fill="currentColor" viewBox="0 0 20 20">
          <path fill-rule="evenodd" d="M2.166 4.999A11.954 11.954 0 0010 1.944 11.954 11.954 0 0017.834 5c.11.65.166 1.32.166 2.001 0 5.225-3.34 9.67-8 11.317C5.34 16.67 2 12.225 2 7c0-.682.057-1.35.166-2.001zm11.541 3.708a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
        </svg>
        Your information is secure and never shared
      </p>
    </div>
  </div>
</section>

<script>
  const form = document.getElementById('deduction-calculator') as HTMLFormElement;
  const results = document.getElementById('results');
  const missedAmount = document.getElementById('missed-amount');
  const monthlySavings = document.getElementById('monthly-savings');
  const missedList = document.getElementById('missed-list');
  
  form?.addEventListener('submit', (e) => {
    e.preventDefault();
    
    const income = parseInt((document.getElementById('income') as HTMLInputElement).value) || 30000;
    const checkedDeductions = document.querySelectorAll('input[type="checkbox"][value]:checked').length;
    
    // Calculate missed deductions based on what they're NOT tracking
    let deductionRate = 0.35; // Base 35% for artists
    
    // Adjust based on income sources
    const incomeSources = document.querySelectorAll('input[type="checkbox"][value^="gallery"]:checked, input[type="checkbox"][value^="online"]:checked, input[type="checkbox"][value^="commissions"]:checked').length;
    if (incomeSources >= 3) deductionRate += 0.05;
    
    // Reduce by what they're already tracking
    deductionRate -= (checkedDeductions * 0.03);
    deductionRate = Math.max(deductionRate, 0.15); // Minimum 15%
    
    const missed = Math.round(income * deductionRate);
    const monthly = Math.round(missed / 12);
    
    // Update results
    if (missedAmount) missedAmount.textContent = missed.toLocaleString();
    if (monthlySavings) monthlySavings.textContent = `$${monthly.toLocaleString()}`;
    
    // Show relevant missed deductions
    const allPossibleDeductions = [
      'Home studio percentage (utilities, rent, insurance)',
      'Cell phone & internet (business percentage)',
      'Professional photography & documentation',
      'Framing & presentation materials',
      'Gallery opening expenses & travel',
      'Art fair booth fees & displays',
      'Professional memberships & subscriptions',
      'Studio assistant or intern costs',
      'Equipment depreciation',
      'Professional development courses',
      'Research materials & museum admissions',
      'Studio music/streaming subscriptions',
      'Shipping & packaging supplies',
      'Business insurance premiums',
      'Marketing & advertising costs'
    ];
    
    // Show 5-7 random deductions they might be missing
    const shuffled = allPossibleDeductions.sort(() => Math.random() - 0.5);
    const toShow = shuffled.slice(0, Math.min(7, Math.max(5, 12 - checkedDeductions)));
    
    if (missedList) {
      missedList.innerHTML = toShow
        .map(item => `<li class="flex items-start gap-2">
          <span class="text-coral mt-1">•</span>
          <span>${item}</span>
        </li>`)
        .join('');
    }
    
    // Show results with smooth scroll
    results?.classList.remove('hidden');
    results?.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
  });
</script>