---
// Business expansion calculator
---

<section id="calculator" class="relative py-24 bg-gradient-to-b from-white to-fog/30">
  <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
    <!-- Header -->
    <div class="text-center mb-16">
      <h2 class="font-display heading-lg text-midnight mb-4">
        Business Expansion
        <span class="text-gradient"> Calculator</span>
      </h2>
      <p class="text-xl text-slate max-w-3xl mx-auto">
        Planning to grow your business? This calculator helps you determine if you're 
        financially ready for expansion—no complex spreadsheets required!
      </p>
    </div>
    
    <!-- Calculator card -->
    <div class="card-bold shadow-modern-lg">
      <form id="expansion-calculator" class="space-y-6">
        <!-- Revenue input -->
        <div>
          <label for="revenue" class="block text-sm font-medium text-midnight mb-2">
            Current Monthly Revenue ($)
          </label>
          <div class="relative">
            <span class="absolute left-4 top-1/2 -translate-y-1/2 text-xl text-slate">$</span>
            <input 
              type="number" 
              id="revenue" 
              class="w-full pl-12 pr-4 py-4 bg-white border-2 border-fog rounded-lg text-xl font-medium focus:border-teal focus:outline-none transition-colors"
              placeholder="10,000"
              min="0"
              step="100"
            />
          </div>
        </div>
        
        <!-- Expenses input -->
        <div>
          <label for="expenses" class="block text-sm font-medium text-midnight mb-2">
            Current Monthly Expenses ($)
          </label>
          <div class="relative">
            <span class="absolute left-4 top-1/2 -translate-y-1/2 text-xl text-slate">$</span>
            <input 
              type="number" 
              id="expenses" 
              class="w-full pl-12 pr-4 py-4 bg-white border-2 border-fog rounded-lg text-xl font-medium focus:border-teal focus:outline-none transition-colors"
              placeholder="7,000"
              min="0"
              step="100"
            />
          </div>
        </div>
        
        <!-- New location rent -->
        <div>
          <label for="newRent" class="block text-sm font-medium text-midnight mb-2">
            Estimated Monthly Rent for New Location ($)
          </label>
          <div class="relative">
            <span class="absolute left-4 top-1/2 -translate-y-1/2 text-xl text-slate">$</span>
            <input 
              type="number" 
              id="newRent" 
              class="w-full pl-12 pr-4 py-4 bg-white border-2 border-fog rounded-lg text-xl font-medium focus:border-teal focus:outline-none transition-colors"
              placeholder="2,500"
              min="0"
              step="100"
            />
          </div>
        </div>
        
        <!-- Setup costs -->
        <div>
          <label for="setupCosts" class="block text-sm font-medium text-midnight mb-2">
            One-Time Setup Costs ($)
          </label>
          <div class="relative">
            <span class="absolute left-4 top-1/2 -translate-y-1/2 text-xl text-slate">$</span>
            <input 
              type="number" 
              id="setupCosts" 
              class="w-full pl-12 pr-4 py-4 bg-white border-2 border-fog rounded-lg text-xl font-medium focus:border-teal focus:outline-none transition-colors"
              placeholder="15,000"
              min="0"
              step="100"
            />
          </div>
          <p class="mt-2 text-sm text-slate">Build-out, equipment, deposits, etc.</p>
        </div>
        
        <!-- Staff costs -->
        <div>
          <label for="staffCosts" class="block text-sm font-medium text-midnight mb-2">
            Additional Monthly Staff Costs ($)
          </label>
          <div class="relative">
            <span class="absolute left-4 top-1/2 -translate-y-1/2 text-xl text-slate">$</span>
            <input 
              type="number" 
              id="staffCosts" 
              class="w-full pl-12 pr-4 py-4 bg-white border-2 border-fog rounded-lg text-xl font-medium focus:border-teal focus:outline-none transition-colors"
              placeholder="3,000"
              min="0"
              step="100"
            />
          </div>
        </div>
        
        <!-- Calculate button -->
        <button type="submit" class="w-full btn-primary">
          Calculate Expansion Feasibility
        </button>
      </form>
      
      <!-- Results (hidden initially) -->
      <div id="results" class="hidden mt-8 p-6 bg-gradient-to-r from-teal/10 to-coral/10 rounded-xl">
        <h3 class="font-serif text-xl text-midnight mb-4">Your Financial Analysis:</h3>
        
        <div class="space-y-3 mb-6">
          <div class="flex justify-between items-center">
            <span class="text-slate">Current Monthly Profit:</span>
            <span class="font-semibold text-midnight text-lg">$<span id="currentProfit">0</span></span>
          </div>
          <div class="flex justify-between items-center">
            <span class="text-slate">Additional Monthly Costs:</span>
            <span class="font-semibold text-midnight text-lg">$<span id="additionalCosts">0</span></span>
          </div>
          <div class="flex justify-between items-center">
            <span class="text-slate">Projected Cash Flow After Expansion:</span>
            <span id="projectedFlow" class="font-semibold text-lg">$0</span>
          </div>
          <div id="recoveryTime" class="flex justify-between items-center">
            <span class="text-slate">Time to Recover Setup Costs:</span>
            <span class="font-semibold text-midnight text-lg"><span id="recoveryMonths">0</span> months</span>
          </div>
        </div>
        
        <div class="p-4 bg-white rounded-lg">
          <p id="recommendation" class="text-sm text-slate leading-relaxed"></p>
        </div>
        
        <div class="mt-6 text-center">
          <p class="text-sm text-slate mb-4">
            Need help planning your expansion financially?
          </p>
          <a href="#contact" class="btn-coral inline-block">
            Let's Talk About Your Goals →
          </a>
        </div>
      </div>
    </div>
    
    <!-- Call to action -->
    <div class="text-center mt-12 space-y-4">
      <p class="text-lg text-slate">
        Your bookkeeping partner should help you make smart growth decisions
      </p>
      <p class="text-sm text-slate">
        <svg class="w-4 h-4 inline mr-1 text-teal" fill="currentColor" viewBox="0 0 20 20">
          <path fill-rule="evenodd" d="M2.166 4.999A11.954 11.954 0 0010 1.944 11.954 11.954 0 0017.834 5c.11.65.166 1.32.166 2.001 0 5.225-3.34 9.67-8 11.317C5.34 16.67 2 12.225 2 7c0-.682.057-1.35.166-2.001zm11.541 3.708a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
        </svg>
        Calculation for illustration purposes only • Consult with a CPA for accurate projections
      </p>
    </div>
  </div>
</section>

<script>
  const form = document.getElementById('expansion-calculator') as HTMLFormElement;
  const results = document.getElementById('results');
  
  form?.addEventListener('submit', (e) => {
    e.preventDefault();
    
    // Get input values
    const revenue = parseFloat((document.getElementById('revenue') as HTMLInputElement).value) || 0;
    const expenses = parseFloat((document.getElementById('expenses') as HTMLInputElement).value) || 0;
    const newRent = parseFloat((document.getElementById('newRent') as HTMLInputElement).value) || 0;
    const setupCosts = parseFloat((document.getElementById('setupCosts') as HTMLInputElement).value) || 0;
    const staffCosts = parseFloat((document.getElementById('staffCosts') as HTMLInputElement).value) || 0;
    
    // Calculate metrics
    const currentProfit = revenue - expenses;
    const additionalCosts = newRent + staffCosts;
    const projectedCashFlow = currentProfit - additionalCosts;
    const monthsToRecover = projectedCashFlow > 0 ? Math.ceil(setupCosts / projectedCashFlow) : 0;
    
    // Update results
    document.getElementById('currentProfit')!.textContent = currentProfit.toLocaleString();
    document.getElementById('additionalCosts')!.textContent = additionalCosts.toLocaleString();
    
    const flowElement = document.getElementById('projectedFlow')!;
    flowElement.textContent = `$${Math.abs(projectedCashFlow).toLocaleString()}`;
    flowElement.className = projectedCashFlow >= 0 ? 'font-semibold text-lg text-teal' : 'font-semibold text-lg text-coral';
    if (projectedCashFlow < 0) {
      flowElement.textContent += ' (deficit)';
    }
    
    // Recovery time
    const recoveryDiv = document.getElementById('recoveryTime')!;
    if (setupCosts > 0 && projectedCashFlow > 0) {
      document.getElementById('recoveryMonths')!.textContent = monthsToRecover.toString();
      recoveryDiv.style.display = 'flex';
    } else {
      recoveryDiv.style.display = 'none';
    }
    
    // Generate recommendation
    const recommendation = document.getElementById('recommendation')!;
    if (currentProfit <= 0) {
      recommendation.innerHTML = `<span class="font-semibold text-coral">Hold off for now.</span> Your current business isn't profitable yet. Focus on increasing revenue or reducing expenses before expanding.`;
    } else if (projectedCashFlow < 0) {
      recommendation.innerHTML = `<span class="font-semibold text-amber">Proceed with caution.</span> The expansion would put you in the red by $${Math.abs(projectedCashFlow).toLocaleString()}/month. Consider ways to increase revenue or reduce expansion costs.`;
    } else if (monthsToRecover > 24) {
      recommendation.innerHTML = `<span class="font-semibold text-amber">This is a long-term investment.</span> It will take ${monthsToRecover} months to recover your setup costs. Make sure you have adequate reserves.`;
    } else if (projectedCashFlow < currentProfit * 0.2) {
      recommendation.innerHTML = `<span class="font-semibold text-teal">Tight but doable.</span> You'll maintain positive cash flow, but margins will be thin. Consider building a 6-month reserve first.`;
    } else {
      recommendation.innerHTML = `<span class="font-semibold text-teal">Looking good!</span> You'll maintain healthy cash flow of $${projectedCashFlow.toLocaleString()}/month and recover setup costs in ${monthsToRecover} months. Smart financial planning!`;
    }
    
    // Show results with smooth scroll
    results?.classList.remove('hidden');
    results?.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
  });
</script>